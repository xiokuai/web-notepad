<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ËÆ∞‰∫ãÊú¨</title>
    
<style>
    /* Áº©ÊîæÈù¢ÊùøÊ†∑Âºè */
    .zoom-container {
        position: fixed;
        top: 100px;
        right: 20px;
        background: #ffffff;
        border: 1px solid #d1d1d1;
        border-radius: 6px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        padding: 12px;
        min-width: 250px;
        display: none;
        z-index: 1500;
    }

    .zoom-options {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    /* ËìùËâ≤ËøõÂ∫¶Êù° */
    .zoom-slider {
        width: 100%;
        margin: 0;
        -webkit-appearance: none;
        background-color: #0078d4;
        height: 8px;
        border-radius: 4px;
    }

    .zoom-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 16px;
        height: 16px;
        background: #0078d4;
        border-radius: 50%;
    }

    .zoom-button {
        padding: 6px 12px;
        background: #005fb8;
        color: white;
        border: none;
        border-radius: 20px; /* ÂúÜËßíÊåâÈíÆ */
        cursor: pointer;
        font-size: 14px;
    }

    .zoom-button:hover {
        background: #004a93;
    }

    /* ÁôæÂàÜÊØîÊòæÁ§∫ */
    #zoomPercentage {
        font-size: 14px;
        color: #1a1a1a;
    }
</style>
<style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f3f3f3;
            overflow: hidden;
            height: 100vh;
        }

        .window {
            display: flex;
            flex-direction: column;
            height: 100vh;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            overflow: hidden;
        }

        .title-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 32px;
            background: #ffffff;
            padding: 0 16px;
            border-bottom: 1px solid #e5e5e5;
            -webkit-app-region: drag;
        }

        .title-bar-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .app-icon {
            width: 16px;
            height: 16px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23005fb8"><path d="M3 3h18v18H3V3zm2 2v14h14V5H5z"/></svg>') no-repeat center;
            background-size: contain;
        }

        .title-text {
            font-size: 12px;
            color: #1a1a1a;
            font-weight: 400;
        }

        .window-controls {
            display: flex;
            -webkit-app-region: no-drag;
        }

        .window-control {
            width: 46px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 10px;
            color: #1a1a1a;
            transition: background-color 0.1s ease;
        }

        .window-control:hover {
            background-color: #e5e5e5;
        }

        .window-control.close:hover {
            background-color: #c42b1c;
            color: white;
        }

        .menu-bar {
            display: flex;
            background: #fafafa;
            border-bottom: 1px solid #e5e5e5;
            padding: 4px 8px;
            min-height: 32px;
        }

        .menu-item {
            padding: 6px 12px;
            font-size: 12px;
            color: #1a1a1a;
            cursor: pointer;
            border-radius: 4px;
            position: relative;
            background: transparent;
            border: none;
            font-family: inherit;
        }

        .menu-item:hover {
            background-color: #e5e5e5;
        }

        .menu-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background: #ffffff;
            border: 1px solid #d1d1d1;
            border-radius: 4px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            min-width: 180px;
            z-index: 1000;
            display: none;
            padding: 4px 0;
        }

        .menu-dropdown.show {
            display: block;
        }

        .menu-dropdown-item {
            padding: 8px 16px;
            font-size: 12px;
            color: #1a1a1a;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .menu-dropdown-item:hover {
            background-color: #f0f0f0;
        }

        .menu-dropdown-item.disabled {
            color: #8a8a8a;
            cursor: default;
        }

        .menu-dropdown-item.disabled:hover {
            background-color: transparent;
        }

        .menu-separator {
            height: 1px;
            background-color: #e5e5e5;
            margin: 4px 0;
        }

        .shortcut {
            font-size: 11px;
            color: #8a8a8a;
        }

        .editor-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .toolbar {
            display: none;
            background: #fafafa;
            border-bottom: 1px solid #e5e5e5;
            padding: 8px 16px;
            gap: 8px;
            align-items: center;
        }

        .toolbar.show {
            display: flex;
        }

        .toolbar button {
            padding: 4px 8px;
            background: #ffffff;
            border: 1px solid #d1d1d1;
            border-radius: 3px;
            font-size: 11px;
            cursor: pointer;
        }

        .toolbar button:hover {
            background: #e5e5e5;
        }

        .text-editor {
            flex: 1;
            padding: 16px;
            border: none;
            outline: none;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
            resize: none;
            background: #ffffff;
            color: #1a1a1a;
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 24px;
            background: #fafafa;
            border-top: 1px solid #e5e5e5;
            padding: 0 16px;
            font-size: 11px;
            color: #8a8a8a;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: #ffffff;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
            min-width: 400px;
            max-width: 600px;
        }

        .save-dialog {
            min-width: 580px;
            max-width: 580px;
            padding: 0;
            border-radius: 6px;
        }

        .save-dialog-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: #f8f8f8;
            border-bottom: 1px solid #e0e0e0;
            border-top-left-radius: 6px;
            border-top-right-radius: 6px;
        }

        .save-dialog-title {
            font-size: 13px;
            font-weight: 400;
            color: #1a1a1a;
        }

        .save-dialog-body {
            padding: 16px;
        }

        .path-bar {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            padding: 6px 8px;
            background: #ffffff;
            border: 1px solid #d0d0d0;
            border-radius: 3px;
            font-size: 12px;
        }

        .path-icon {
            width: 16px;
            height: 16px;
            margin-right: 8px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23f39c12"><path d="M10 4H4c-1.11 0-2 .89-2 2v12c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2h-8l-2-2z"/></svg>') no-repeat center;
            background-size: contain;
        }

        .file-list {
            height: 200px;
            border: 1px solid #d0d0d0;
            border-radius: 3px;
            background: #ffffff;
            margin-bottom: 12px;
            overflow-y: auto;
        }

        .file-item {
            display: flex;
            align-items: center;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
        }

        .file-item:hover {
            background: #e3f2fd;
        }

        .file-item.selected {
            background: #0078d4;
            color: white;
        }

        .file-icon {
            width: 16px;
            height: 16px;
            margin-right: 8px;
            background-size: contain;
        }

        .folder-icon {
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23f39c12"><path d="M10 4H4c-1.11 0-2 .89-2 2v12c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2h-8l-2-2z"/></svg>') no-repeat center;
        }

        .txt-icon {
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%236c757d"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/></svg>') no-repeat center;
        }

        .form-group {
            margin-bottom: 12px;
        }

        .form-label {
            display: block;
            font-size: 12px;
            color: #1a1a1a;
            margin-bottom: 4px;
        }

        .form-input {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #d0d0d0;
            border-radius: 3px;
            font-size: 12px;
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: #0078d4;
            box-shadow: 0 0 0 1px #0078d4;
        }

        .form-select {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #d0d0d0;
            border-radius: 3px;
            font-size: 12px;
            background: white;
            font-family: inherit;
        }

        .form-row {
            display: flex;
            gap: 12px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .save-dialog-footer {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
            padding: 16px;
            background: #f8f8f8;
            border-top: 1px solid #e0e0e0;
            border-bottom-left-radius: 6px;
            border-bottom-right-radius: 6px;
        }

        .toolbar-group {
            display: flex;
            align-items: center;
            gap: 4px;
            margin-bottom: 8px;
        }

        .toolbar-btn {
            padding: 4px 8px;
            background: #f0f0f0;
            border: 1px solid #d0d0d0;
            border-radius: 3px;
            font-size: 11px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .toolbar-btn:hover {
            background: #e0e0e0;
        }

        .toolbar-btn.active {
            background: #0078d4;
            color: white;
            border-color: #0078d4;
        }

        .modal-header {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            color: #1a1a1a;
        }

        .modal-body {
            margin-bottom: 20px;
            color: #5a5a5a;
            line-height: 1.5;
        }

        .modal-buttons {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        .btn {
            padding: 8px 16px;
            border: 1px solid #d1d1d1;
            border-radius: 4px;
            background: #ffffff;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-primary {
            background: #005fb8;
            color: white;
            border-color: #005fb8;
        }

        .btn:hover {
            background: #e5e5e5;
        }

        .btn-primary:hover {
            background: #004a93;
        }

        .search-container {
            position: absolute;
            top: 80px;
            right: 20px;
            background: #ffffff;
            border: 1px solid #d1d1d1;
            border-radius: 6px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            padding: 12px;
            min-width: 300px;
            display: none;
            z-index: 1500;
        }

        .search-container.show {
            display: block;
        }

        .search-input {
            width: 100%;
            padding: 6px 8px;
            border: 1px solid #d1d1d1;
            border-radius: 3px;
            margin-bottom: 8px;
            font-size: 12px;
        }

        .search-buttons {
            display: flex;
            gap: 8px;
        }

        .search-btn {
            padding: 4px 12px;
            background: #005fb8;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
        }

        .search-btn:hover {
            background: #004a93;
        }
    </style>

<!-- highlight.js Ê†∑ÂºèÂíåËÑöÊú¨ -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
<script>hljs.highlightAll();</script>

</head>
<body>
    <div class="window">
        <!-- Ê†áÈ¢òÊ†è -->
        <div class="title-bar">
            <div class="title-bar-left">
                <div class="app-icon"></div>
                <span class="title-text" id="titleText">Êó†Ê†áÈ¢ò - ËÆ∞‰∫ãÊú¨</span>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" onclick="minimizeWindow()">üóï</button>
                <button class="window-control maximize" onclick="maximizeWindow()">üóó</button>
                <button class="window-control close" onclick="closeWindow()">üóô</button>
            </div>
        </div>

        <!-- ËèúÂçïÊ†è -->
        <div class="menu-bar">
            <div class="menu-item" onclick="toggleMenu('fileMenu')">Êñá‰ª∂(F)
                <div class="menu-dropdown" id="fileMenu">
                    <div class="menu-dropdown-item" onclick="newFile()">Êñ∞Âª∫ <span class="shortcut">Ctrl+N</span></div>
                    <div class="menu-dropdown-item" onclick="openFile()">ÊâìÂºÄ... <span class="shortcut">Ctrl+O</span></div>
                    <div class="menu-dropdown-item" onclick="saveFile()">‰øùÂ≠ò <span class="shortcut">Ctrl+S</span></div>
                    <div class="menu-dropdown-item" onclick="saveAs()">Âè¶Â≠ò‰∏∫... <span class="shortcut">Ctrl+Shift+S</span></div>
                    <div class="menu-separator"></div>
                    <div class="menu-dropdown-item" onclick="pageSetup()">È°µÈù¢ËÆæÁΩÆ...</div>
                    <div class="menu-dropdown-item" onclick="printFile()">ÊâìÂç∞... <span class="shortcut">Ctrl+P</span></div>
                    <div class="menu-separator"></div>
                    <div class="menu-dropdown-item" onclick="closeWindow()">ÈÄÄÂá∫</div>
                </div>
            </div>
            <div class="menu-item" onclick="toggleMenu('editMenu')">ÁºñËæë(E)
                <div class="menu-dropdown" id="editMenu">
                    <div class="menu-dropdown-item" onclick="undoAction()">Êí§ÈîÄ <span class="shortcut">Ctrl+Z</span></div>
                    <div class="menu-separator"></div>
                    <div class="menu-dropdown-item" onclick="cutText()">Ââ™Âàá <span class="shortcut">Ctrl+X</span></div>
                    <div class="menu-dropdown-item" onclick="copyText()">Â§çÂà∂ <span class="shortcut">Ctrl+C</span></div>
                    <div class="menu-dropdown-item" onclick="pasteText()">Á≤òË¥¥ <span class="shortcut">Ctrl+V</span></div>
                    <div class="menu-dropdown-item" onclick="deleteText()">Âà†Èô§ <span class="shortcut">Del</span></div>
                    <div class="menu-separator"></div>
                    <div class="menu-dropdown-item" onclick="findText()">Êü•Êâæ... <span class="shortcut">Ctrl+F</span></div>
                    <div class="menu-dropdown-item" onclick="findNext()">Êü•Êâæ‰∏ã‰∏Ä‰∏™ <span class="shortcut">F3</span></div>
                    <div class="menu-dropdown-item" onclick="replaceText()">ÊõøÊç¢... <span class="shortcut">Ctrl+H</span></div>
                    <div class="menu-dropdown-item" onclick="goToLine()">ËΩ¨Âà∞... <span class="shortcut">Ctrl+G</span></div>
                    <div class="menu-separator"></div>
                    <div class="menu-dropdown-item" onclick="selectAll()">ÂÖ®ÈÄâ <span class="shortcut">Ctrl+A</span></div>
                    <div class="menu-dropdown-item" onclick="timeDate()">Êó∂Èó¥/Êó•Êúü <span class="shortcut">F5</span></div>
                </div>
            </div>
            <div class="menu-item" onclick="toggleMenu('formatMenu')">Ê†ºÂºè(O)
                <div class="menu-dropdown" id="formatMenu">
                    <div class="menu-dropdown-item" onclick="toggleWordWrap()">Ëá™Âä®Êç¢Ë°å</div>
                    <div class="menu-dropdown-item" onclick="setFont()">Â≠ó‰Ωì...</div>
                </div>
            </div>
            <div class="menu-item" onclick="toggleMenu('viewMenu')">Êü•Áúã(V)
                <div class="menu-dropdown" id="viewMenu">
                    <div class="menu-dropdown-item" onclick="toggleZoom()">Áº©Êîæ</div>
                    <div class="menu-dropdown-item" onclick="toggleStatusBar()">Áä∂ÊÄÅÊ†è</div>
                </div>
            </div>
            <div class="menu-item" onclick="toggleMenu('helpMenu')">Â∏ÆÂä©(H)
                <div class="menu-dropdown" id="helpMenu">
                    <div class="menu-dropdown-item" onclick="viewHelp()">Êü•ÁúãÂ∏ÆÂä©</div>
                    <div class="menu-dropdown-item" onclick="sendFeedback()">ÂèëÈÄÅÂèçÈ¶à</div>
                    <div class="menu-separator"></div>
                    <div class="menu-dropdown-item" onclick="aboutNotepad()">ÂÖ≥‰∫éËÆ∞‰∫ãÊú¨</div>
                </div>
            </div>
        </div>

        <!-- ÁºñËæëÂô®ÂÆπÂô® -->
        <div class="editor-container">
<!-- Áº©ÊîæÂºπÁ™ó -->
<div class="modal" id="zoomModal">
    <div class="modal-content">
        <div class="modal-header">
            <span class="modal-title">Ë∞ÉÊï¥Â≠ó‰ΩìÂ§ßÂ∞è</span>
            <button class="window-control" onclick="closeZoomModal()" style="width: 32px; height: 24px;">‚úï</button>
        </div>
        <div class="modal-body">
            <label for="zoomSlider">Â≠ó‰ΩìÂ§ßÂ∞è</label>
            <input type="range" id="zoomSlider" class="zoom-slider" min="10" max="36" step="1" value="14" oninput="updateFontSize(this.value)">
            <div class="zoom-options">
                <button onclick="setZoomLevel(12)">Â∞è</button>
                <button onclick="setZoomLevel(14)">‰∏≠</button>
                <button onclick="setZoomLevel(16)">Â§ß</button>
                <button onclick="setZoomLevel(18)">Ë∂ÖÂ§ß</button>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn" onclick="closeZoomModal()">ÂèñÊ∂à</button>
            <button class="btn btn-primary" onclick="applyZoom()">Á°ÆËÆ§</button>
        </div>
    </div>
</div>

            <textarea class="text-editor" id="textEditor" placeholder="ÂºÄÂßãËæìÂÖ•..." oninput="updateStatus()" onselectionchange="updateStatus()"></textarea>
<pre id="highlightViewer" class="text-editor" style="display:none; overflow:auto;"><code class="language-javascript" id="highlightCode"></code></pre>

        </div>

        <!-- Áä∂ÊÄÅÊ†è -->
        <div class="status-bar" id="statusBar">
            <div class="status-left">
                <span id="lineCol">Á¨¨ 1 Ë°åÔºåÁ¨¨ 1 Âàó</span>
            </div>
            <div class="status-right">
                <span>Windows (CRLF)</span>
                <span>UTF-8</span>
                <span>100%</span>
            </div>
        </div>
    </div>

    <!-- ÊêúÁ¥¢Ê°Ü -->
    <div class="search-container" id="searchContainer">
        <input type="text" class="search-input" id="searchInput" placeholder="Êü•ÊâæÂÜÖÂÆπ">
        <div class="search-buttons">
            <button class="search-btn" onclick="searchNext()">Êü•Êâæ‰∏ã‰∏Ä‰∏™</button>
            <button class="search-btn" onclick="searchPrevious()">Êü•Êâæ‰∏ä‰∏Ä‰∏™</button>
            <button class="search-btn" onclick="closeSearch()">ÂÖ≥Èó≠</button>
        </div>
    </div>

    <!-- ‰øùÂ≠òÂØπËØùÊ°Ü -->
    <div class="modal" id="saveModal">
        <div class="modal-content save-dialog">
            <div class="save-dialog-header">
                <span class="save-dialog-title">Âè¶Â≠ò‰∏∫</span>
                <button class="window-control" onclick="closeSaveDialog()" style="width: 32px; height: 24px;">‚úï</button>
            </div>
            <div class="save-dialog-body">
                <div class="toolbar-group">
                    <button class="toolbar-btn" onclick="navigateUp()">‚Üë ‰∏ä‰∏ÄÁ∫ß</button>
                    <button class="toolbar-btn active" onclick="setViewMode('list')">üìã ÂàóË°®</button>
                    <button class="toolbar-btn" onclick="setViewMode('details')">üìä ËØ¶ÁªÜ‰ø°ÊÅØ</button>
                </div>
                
                <div class="path-bar">
                    <div class="path-icon"></div>
                    <span id="currentPath">Ê≠§ÁîµËÑë > ÊñáÊ°£</span>
                </div>
                
                <div class="file-list" id="fileList">
                    <div class="file-item" onclick="selectFolder(this)">
                        <div class="file-icon folder-icon"></div>
                        <span>Ê°åÈù¢</span>
                    </div>
                    <div class="file-item" onclick="selectFolder(this)">
                        <div class="file-icon folder-icon"></div>
                        <span>‰∏ãËΩΩ</span>
                    </div>
                    <div class="file-item" onclick="selectFolder(this)">
                        <div class="file-icon folder-icon"></div>
                        <span>ÊñáÊ°£</span>
                    </div>
                    <div class="file-item" onclick="selectFile(this, 'Á§∫‰æãÊñáÊ°£.txt')">
                        <div class="file-icon txt-icon"></div>
                        <span>Á§∫‰æãÊñáÊ°£.txt</span>
                    </div>
                    <div class="file-item" onclick="selectFile(this, 'ËÆ∞ÂΩï.txt')">
                        <div class="file-icon txt-icon"></div>
                        <span>ËÆ∞ÂΩï.txt</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Êñá‰ª∂Âêç(N):</label>
                    <input type="text" class="form-input" id="saveFileName" value="Êó†Ê†áÈ¢ò.txt">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">‰øùÂ≠òÁ±ªÂûã(T):</label>
                        <select class="form-select" id="saveFileType">
                            <option value="txt">ÊñáÊú¨ÊñáÊ°£ (*.txt)</option>
                            <option value="all">ÊâÄÊúâÊñá‰ª∂ (*.*)</option>
                            <option value="md">MarkdownÊñá‰ª∂ (*.md)</option>
                            <option value="html">HTMLÊñá‰ª∂ (*.html)</option>
                            <option value="js">JavaScriptÊñá‰ª∂ (*.js)</option>
                            <option value="css">CSSÊñá‰ª∂ (*.css)</option>
                            <option value="json">JSONÊñá‰ª∂ (*.json)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ÁºñÁ†Å(E):</label>
                        <select class="form-select" id="saveEncoding">
                            <option value="utf-8">UTF-8</option>
                            <option value="utf-8-bom">UTF-8 with BOM</option>
                            <option value="utf-16le">UTF-16 LE</option>
                            <option value="utf-16be">UTF-16 BE</option>
                            <option value="ansi">ANSI</option>
                            <option value="gb2312">GB2312</option>
                            <option value="big5">Big5</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="save-dialog-footer">
                <button class="btn" onclick="closeSaveDialog()">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="confirmSave()">‰øùÂ≠ò(S)</button>
            </div>
        </div>
    </div>

    <!-- ÈÄöÁî®Ê®°ÊÄÅÊ°Ü -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header" id="modalHeader">Ê†áÈ¢ò</div>
            <div class="modal-body" id="modalBody">ÂÜÖÂÆπ</div>
            <div class="modal-buttons">
                <button class="btn" onclick="closeModal()">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="confirmModal()">Á°ÆÂÆö</button>
            </div>
        </div>
    </div>

    <script>
        let currentFile = null;
        let isModified = false;
        let searchIndex = -1;
        let lastSearchTerm = '';
        let currentDirectory = 'ÊñáÊ°£';
        let selectedEncoding = 'utf-8';

        const textEditor = document.getElementById('textEditor');
        const titleText = document.getElementById('titleText');
        const statusBar = document.getElementById('statusBar');
        const modal = document.getElementById('modal');
        const saveModal = document.getElementById('saveModal');
        const searchContainer = document.getElementById('searchContainer');

        // Êõ¥Êñ∞Ê†áÈ¢ò
        function updateTitle() {
            const fileName = currentFile ? currentFile.split('/').pop() : 'Êó†Ê†áÈ¢ò';
            const modified = isModified ? '*' : '';
            titleText.textContent = `${modified}${fileName} - ËÆ∞‰∫ãÊú¨`;
        }

        // Êõ¥Êñ∞Áä∂ÊÄÅÊ†è
        function updateStatus() {
            const text = textEditor.value;
            const position = textEditor.selectionStart;
            const lines = text.substring(0, position).split('\n');
            const line = lines.length;
            const col = lines[lines.length - 1].length + 1;
            
            document.getElementById('lineCol').textContent = `Á¨¨ ${line} Ë°åÔºåÁ¨¨ ${col} Âàó`;
            
            if (!isModified && text !== '') {
                isModified = true;
                updateTitle();
            }
        }

        // ËèúÂçïÊìç‰Ωú
        function toggleMenu(menuId) {
            const menu = document.getElementById(menuId);
            const allMenus = document.querySelectorAll('.menu-dropdown');
            
            allMenus.forEach(m => {
                if (m.id !== menuId) {
                    m.classList.remove('show');
                }
            });
            
            menu.classList.toggle('show');
        }

        // ÂÖ≥Èó≠ÊâÄÊúâËèúÂçï
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.menu-item')) {
                document.querySelectorAll('.menu-dropdown').forEach(menu => {
                    menu.classList.remove('show');
                });
            }
        });

        // Êñá‰ª∂Êìç‰Ωú
        function newFile() {
            if (isModified) {
                showModal('ËÆ∞‰∫ãÊú¨', 'ÊòØÂê¶Ë¶Å‰øùÂ≠òÂØπÊñá‰ª∂ÁöÑÊõ¥ÊîπÔºü', () => {
                    saveFile();
                    createNewFile();
                });
            } else {
                createNewFile();
            }
        }

        function createNewFile() {
            textEditor.value = '';
            currentFile = null;
            isModified = false;
            updateTitle();
            updateStatus();
        }

        function openFile() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.txt,.md,.json,.js,.css,.html,.xml';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        textEditor.value = e.target.result;
                        currentFile = file.name;
                        isModified = false;
                        updateTitle();
                        updateStatus();
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        function saveFile() {
            if (currentFile) {
                downloadFile(textEditor.value, currentFile);
                isModified = false;
                updateTitle();
            } else {
                saveAs();
            }
        }

        function saveAs() {
            showSaveDialog();
        }

        function showSaveDialog() {
            const fileName = currentFile || 'Êó†Ê†áÈ¢ò.txt';
            document.getElementById('saveFileName').value = fileName;
            document.getElementById('currentPath').textContent = `Ê≠§ÁîµËÑë > ${currentDirectory}`;
            saveModal.classList.add('show');
        }

        function closeSaveDialog() {
            saveModal.classList.remove('show');
        }

        function selectFolder(element) {
            // Ê∏ÖÈô§‰πãÂâçÁöÑÈÄâÊã©
            document.querySelectorAll('.file-item').forEach(item => {
                item.classList.remove('selected');
            });
            element.classList.add('selected');
            
            // ÂèåÂáªËøõÂÖ•Êñá‰ª∂Â§π
            element.addEventListener('dblclick', () => {
                const folderName = element.querySelector('span').textContent;
                navigateToFolder(folderName);
            });
        }

        function selectFile(element, fileName) {
            // Ê∏ÖÈô§‰πãÂâçÁöÑÈÄâÊã©
            document.querySelectorAll('.file-item').forEach(item => {
                item.classList.remove('selected');
            });
            element.classList.add('selected');
            
            // ËÆæÁΩÆÊñá‰ª∂Âêç
            document.getElementById('saveFileName').value = fileName;
        }

        function navigateToFolder(folderName) {
            currentDirectory = folderName;
            document.getElementById('currentPath').textContent = `Ê≠§ÁîµËÑë > ${folderName}`;
            
            // Êõ¥Êñ∞Êñá‰ª∂ÂàóË°®ÔºàÊ®°Êãü‰∏çÂêåÊñá‰ª∂Â§πÁöÑÂÜÖÂÆπÔºâ
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = generateFolderContent(folderName);
        }

        function navigateUp() {
            if (currentDirectory !== 'Ê≠§ÁîµËÑë') {
                currentDirectory = 'Ê≠§ÁîµËÑë';
                document.getElementById('currentPath').textContent = 'Ê≠§ÁîµËÑë';
                const fileList = document.getElementById('fileList');
                fileList.innerHTML = generateFolderContent('Ê≠§ÁîµËÑë');
            }
        }

        function generateFolderContent(folderName) {
            const folderContents = {
                'Ê≠§ÁîµËÑë': `
                    <div class="file-item" onclick="selectFolder(this)">
                        <div class="file-icon folder-icon"></div>
                        <span>Ê°åÈù¢</span>
                    </div>
                    <div class="file-item" onclick="selectFolder(this)">
                        <div class="file-icon folder-icon"></div>
                        <span>‰∏ãËΩΩ</span>
                    </div>
                    <div class="file-item" onclick="selectFolder(this)">
                        <div class="file-icon folder-icon"></div>
                        <span>ÊñáÊ°£</span>
                    </div>
                    <div class="file-item" onclick="selectFolder(this)">
                        <div class="file-icon folder-icon"></div>
                        <span>ÂõæÁâá</span>
                    </div>
                `,
                'Ê°åÈù¢': `
                    <div class="file-item" onclick="selectFile(this, 'Êñ∞Âª∫ÊñáÊú¨ÊñáÊ°£.txt')">
                        <div class="file-icon txt-icon"></div>
                        <span>Êñ∞Âª∫ÊñáÊú¨ÊñáÊ°£.txt</span>
                    </div>
                `,
                '‰∏ãËΩΩ': `
                    <div class="file-item" onclick="selectFile(this, '‰∏ãËΩΩÊñá‰ª∂.txt')">
                        <div class="file-icon txt-icon"></div>
                        <span>‰∏ãËΩΩÊñá‰ª∂.txt</span>
                    </div>
                `,
                'ÊñáÊ°£': `
                    <div class="file-item" onclick="selectFile(this, 'Á§∫‰æãÊñáÊ°£.txt')">
                        <div class="file-icon txt-icon"></div>
                        <span>Á§∫‰æãÊñáÊ°£.txt</span>
                    </div>
                    <div class="file-item" onclick="selectFile(this, 'ËÆ∞ÂΩï.txt')">
                        <div class="file-icon txt-icon"></div>
                        <span>ËÆ∞ÂΩï.txt</span>
                    </div>
                `,
                'ÂõæÁâá': `
                    <div class="file-item" onclick="selectFile(this, 'Êà™Âõæ.png')">
                        <div class="file-icon txt-icon"></div>
                        <span>Êà™Âõæ.png</span>
                    </div>
                `
            };
            
            return folderContents[folderName] || folderContents['Ê≠§ÁîµËÑë'];
        }

        function setViewMode(mode) {
            document.querySelectorAll('.toolbar-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function confirmSave() {
            const fileName = document.getElementById('saveFileName').value;
            const fileType = document.getElementById('saveFileType').value;
            const encoding = document.getElementById('saveEncoding').value;
            
            if (!fileName.trim()) {
                alert('ËØ∑ËæìÂÖ•Êñá‰ª∂Âêç');
                return;
            }
            
            selectedEncoding = encoding;
            
            // Ê†πÊçÆÊñá‰ª∂Á±ªÂûãÊ∑ªÂä†Êâ©Â±ïÂêç
            let finalFileName = fileName;
            if (fileType !== 'all' && !fileName.includes('.')) {
                const extensions = {
                    'txt': '.txt',
                    'md': '.md',
                    'html': '.html',
                    'js': '.js',
                    'css': '.css',
                    'json': '.json'
                };
                finalFileName += extensions[fileType] || '.txt';
            }
            
            downloadFileWithEncoding(textEditor.value, finalFileName, encoding);
            currentFile = finalFileName;
            isModified = false;
            updateTitle();
            closeSaveDialog();
        }

        function downloadFileWithEncoding(content, fileName, encoding) {
            let blob;
            
            switch (encoding) {
                case 'utf-8':
                    blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
                    break;
                case 'utf-8-bom':
                    const BOM = '\uFEFF';
                    blob = new Blob([BOM + content], { type: 'text/plain;charset=utf-8' });
                    break;
                case 'utf-16le':
                    const utf16Array = new Uint16Array(content.length + 1);
                    utf16Array[0] = 0xFEFF; // BOM for UTF-16LE
                    for (let i = 0; i < content.length; i++) {
                        utf16Array[i + 1] = content.charCodeAt(i);
                    }
                    blob = new Blob([utf16Array], { type: 'text/plain;charset=utf-16le' });
                    break;
                case 'utf-16be':
                    const utf16BEArray = new Uint16Array(content.length + 1);
                    utf16BEArray[0] = 0xFFFE; // BOM for UTF-16BE
                    for (let i = 0; i < content.length; i++) {
                        const code = content.charCodeAt(i);
                        utf16BEArray[i + 1] = ((code & 0xFF) << 8) | (code >> 8);
                    }
                    blob = new Blob([utf16BEArray], { type: 'text/plain;charset=utf-16be' });
                    break;
                default:
                    blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            }
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            a.click();
            URL.revokeObjectURL(url);
        }

        function downloadFile(content, fileName) {
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            a.click();
            URL.revokeObjectURL(url);
        }

        // ÁºñËæëÊìç‰Ωú
        function undoAction() {
            document.execCommand('undo');
        }

        function cutText() {
            document.execCommand('cut');
        }

        function copyText() {
            document.execCommand('copy');
        }

        function pasteText() {
            document.execCommand('paste');
        }

        function deleteText() {
            const start = textEditor.selectionStart;
            const end = textEditor.selectionEnd;
            if (start !== end) {
                textEditor.setRangeText('', start, end);
            }
        }

        function selectAll() {
            textEditor.select();
        }

        function timeDate() {
            const now = new Date();
            const timeStr = now.toLocaleString();
            const start = textEditor.selectionStart;
            textEditor.setRangeText(timeStr, start, start);
            textEditor.focus();
        }

        // Êü•ÊâæÂäüËÉΩ
        function findText() {
            searchContainer.classList.add('show');
            document.getElementById('searchInput').focus();
        }

        function closeSearch() {
            searchContainer.classList.remove('show');
        }

        function searchNext() {
            const searchTerm = document.getElementById('searchInput').value;
            if (!searchTerm) return;
            
            const text = textEditor.value;
            const currentPos = textEditor.selectionStart;
            
            if (searchTerm !== lastSearchTerm) {
                searchIndex = -1;
                lastSearchTerm = searchTerm;
            }
            
            const index = text.indexOf(searchTerm, searchIndex + 1);
            if (index !== -1) {
                textEditor.setSelectionRange(index, index + searchTerm.length);
                textEditor.focus();
                searchIndex = index;
            } else {
                // ‰ªéÂ§¥ÂºÄÂßãÊêúÁ¥¢
                const firstIndex = text.indexOf(searchTerm, 0);
                if (firstIndex !== -1) {
                    textEditor.setSelectionRange(firstIndex, firstIndex + searchTerm.length);
                    textEditor.focus();
                    searchIndex = firstIndex;
                }
            }
        }

        function searchPrevious() {
            const searchTerm = document.getElementById('searchInput').value;
            if (!searchTerm) return;
            
            const text = textEditor.value;
            
            if (searchTerm !== lastSearchTerm) {
                lastSearchTerm = searchTerm;
                searchIndex = text.length;
            }
            
            const index = text.lastIndexOf(searchTerm, searchIndex - 1);
            if (index !== -1) {
                textEditor.setSelectionRange(index, index + searchTerm.length);
                textEditor.focus();
                searchIndex = index;
            }
        }

        // ÂÖ∂‰ªñÂäüËÉΩ
        function toggleWordWrap() {
            const wrap = textEditor.style.whiteSpace === 'pre-wrap' ? 'pre' : 'pre-wrap';
            textEditor.style.whiteSpace = wrap;
        }

        function toggleStatusBar() {
            statusBar.style.display = statusBar.style.display === 'none' ? 'flex' : 'none';
        }

        // Á™óÂè£ÊéßÂà∂
        function minimizeWindow() {
            showModal('ËÆ∞‰∫ãÊú¨', 'ÊúÄÂ∞èÂåñÂäüËÉΩÂú®ÊµèËßàÂô®ÁéØÂ¢É‰∏≠‰∏çÂèØÁî®');
        }

        function maximizeWindow() {
            if (document.fullscreenElement) {
                document.exitFullscreen();
            } else {
                document.documentElement.requestFullscreen();
            }
        }

        function closeWindow() {
            if (isModified) {
                showModal('ËÆ∞‰∫ãÊú¨', 'ÊòØÂê¶Ë¶Å‰øùÂ≠òÂØπÊñá‰ª∂ÁöÑÊõ¥ÊîπÔºü', () => {
                    saveFile();
                    window.close();
                });
            } else {
                window.close();
            }
        }

        // Ê®°ÊÄÅÊ°Ü
        function showModal(title, message, onConfirm = null) {
            document.getElementById('modalHeader').textContent = title;
            document.getElementById('modalBody').textContent = message;
            modal.classList.add('show');
            modal.onConfirm = onConfirm;
        }

        function closeModal() {
            modal.classList.remove('show');
        }

        function confirmModal() {
            if (modal.onConfirm) {
                modal.onConfirm();
            }
            closeModal();
        }

        // Âç†‰ΩçÁ¨¶ÂäüËÉΩ
        function pageSetup() { showModal('È°µÈù¢ËÆæÁΩÆ', 'È°µÈù¢ËÆæÁΩÆÂäüËÉΩ'); }
        function printFile() { showModal('ÊâìÂç∞', 'ÊâìÂç∞ÂäüËÉΩ'); }
        function findNext() { searchNext(); }
        function replaceText() { showModal('ÊõøÊç¢', 'ÊõøÊç¢ÂäüËÉΩ'); }
        function goToLine() { showModal('ËΩ¨Âà∞', 'ËΩ¨Âà∞ÊåáÂÆöË°åÂäüËÉΩ'); }
        function setFont() { showModal('Â≠ó‰Ωì', 'Â≠ó‰ΩìËÆæÁΩÆÂäüËÉΩ'); }
        function toggleZoom() { showModal('Áº©Êîæ', 'Áº©ÊîæÂäüËÉΩ'); }
        function viewHelp() { showModal('Â∏ÆÂä©', 'ËÆ∞‰∫ãÊú¨Â∏ÆÂä©ÊñáÊ°£'); }
        function sendFeedback() { showModal('ÂèçÈ¶à', 'ÂèëÈÄÅÂèçÈ¶àÂäüËÉΩ'); }
        function aboutNotepad() { showModal('ÂÖ≥‰∫éËÆ∞‰∫ãÊú¨', 'ËÆ∞‰∫ãÊú¨ v1.0\nÂü∫‰∫éWebÊäÄÊúØÂºÄÂèëÁöÑWindows 11È£éÊ†ºËÆ∞‰∫ãÊú¨'); }

        // ÈîÆÁõòÂø´Êç∑ÈîÆ
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey) {
                switch (e.key) {
                    case 'n':
                        e.preventDefault();
                        newFile();
                        break;
                    case 'o':
                        e.preventDefault();
                        openFile();
                        break;
                    case 's':
                        e.preventDefault();
                        if (e.shiftKey) {
                            saveAs();
                        } else {
                            saveFile();
                        }
                        break;
                    case 'f':
                        e.preventDefault();
                        findText();
                        break;
                    case 'a':
                        e.preventDefault();
                        selectAll();
                        break;
                    case 'p':
                        e.preventDefault();
                        printFile();
                        break;
                }
            } else if (e.key === 'F5') {
                e.preventDefault();
                timeDate();
            } else if (e.key === 'F3') {
                e.preventDefault();
                searchNext();
            } else if (e.key === 'Escape') {
                closeSearch();
                closeModal();
                closeSaveDialog();
            }
        });

        
let highlightMode = false;

function toggleZoom() {
    const zoomModal = document.getElementById('zoomModal');
    zoomModal.style.display = zoomModal.style.display === 'none' ? 'flex' : 'none';
}

function closeZoomModal() {
    const zoomModal = document.getElementById('zoomModal');
    zoomModal.style.display = 'none';
}

function setZoomLevel(size) {
    const textEditor = document.getElementById('textEditor');
    textEditor.style.fontSize = size + 'px';
    document.getElementById('zoomSlider').value = size;  // Êõ¥Êñ∞ÊªëÂä®Êù°
    updateZoomPercentage(size);  // Êõ¥Êñ∞ÁôæÂàÜÊØîÊòæÁ§∫
}

function updateFontSize(size) {
    const textEditor = document.getElementById('textEditor');
    textEditor.style.fontSize = size + 'px';
    updateZoomPercentage(size);  // Êõ¥Êñ∞ÁôæÂàÜÊØîÊòæÁ§∫
}

function updateZoomPercentage(size) {
    const percentage = Math.round((size - 10) / 26 * 100);  // ËÆ°ÁÆóÁôæÂàÜÊØî
    document.getElementById('zoomPercentage').textContent = percentage + '%';  // Êõ¥Êñ∞ÊòæÁ§∫
}

function applyZoom() {
    const size = document.getElementById('zoomSlider').value;
    setZoomLevel(size);
    closeZoomModal();
}

function toggleHighlightView() {
    highlightMode = !highlightMode;

    const code = textEditor.value;
    const viewer = document.getElementById('highlightViewer');
    const codeElem = document.getElementById('highlightCode');

    if (highlightMode) {
        textEditor.style.display = 'none';
        viewer.style.display = 'block';

        // ËÆæÁΩÆËØ≠Ë®ÄÁ±ªÂà´ÔºåÂèØÊ†πÊçÆÈúÄË¶ÅÂä®ÊÄÅËÆæÁΩÆ
        codeElem.className = 'language-javascript';
        codeElem.textContent = code;

        hljs.highlightElement(codeElem);
    } else {
        viewer.style.display = 'none';
        textEditor.style.display = 'block';
    }
}


        // ÂàùÂßãÂåñ
        updateStatus();
        updateStatusBarEncoding();
        textEditor.focus();
    </script>
</body>
</html>
